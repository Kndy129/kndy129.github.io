<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Simulador de Certificações</title>
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  
  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-firestore-compat.js"></script>

<style>
  /* Reset e configurações básicas */
  * {
    box-sizing: border-box;
  }
  
  body {
    margin: 0;
    padding: 0;
    font-family: Arial, sans-serif;
    background-image: url('WallPaper.jpeg');
    background-size: cover;
    background-position: center;
    background-attachment: fixed;
    color: #333;
    line-height: 1.6;
  }

  /* Camada sutil escurecendo a imagem de fundo */
  body::before {
    content: "";
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.35);
    z-index: -1;
  }

  /* Container principal responsivo */
  .container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 15px;
  }

  /* Header com informações do usuário */
  .header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 15px 0;
    margin-bottom: 20px;
    border-bottom: 2px solid rgba(255,255,255,0.1);
  }

  .user-info {
    display: flex;
    align-items: center;
    gap: 15px;
    background: rgba(255,255,255,0.95);
    padding: 10px 15px;
    border-radius: 8px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.2);
  }

  .user-details {
    display: flex;
    flex-direction: column;
  }

  .user-name {
    font-weight: bold;
    color: #004080;
    font-size: 14px;
  }

  .user-email {
    font-size: 12px;
    color: #666;
  }

  .btn-logoff {
    background-color: #f44336;
    color: white;
    border: none;
    padding: 8px 15px;
    border-radius: 6px;
    cursor: pointer;
    font-size: 14px;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    gap: 5px;
  }

  .btn-logoff:hover {
    background-color: #d32f2f;
    transform: translateY(-2px);
  }

  .btn-logoff:active {
    transform: translateY(0);
  }

  .logout-icon {
    width: 16px;
    height: 16px;
  }

  /* Estilos para a notificação +1 */
  .plusOne {
    position: absolute;
    right: 15px;
    top: 15px;
    color: green;
    font-weight: bold;
    font-size: 1.2em;
    opacity: 0;
    transition: all 0.5s ease-in-out;
    pointer-events: none;
    z-index: 10;
  }
  .plusOne.show {
    opacity: 1;
    animation: floatUp 1s ease-in-out forwards;
  }
  @keyframes floatUp {
    0% { transform: translateY(0); opacity: 1; }
    100% { transform: translateY(-30px); opacity: 0; }
  }
    
  .question-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 10px;
    flex-wrap: wrap;
  }
  .question-text {
    flex: 1;
    min-width: 250px;
  }
  .question-actions {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-top: 10px;
  }

  h1, h2 {
    color: #004080;
  }

  .question {
    margin-bottom: 20px;
    padding: 15px;
    border: 1px solid #ccc;
    border-radius: 8px;
    background: rgba(255,255,255,0.92);
    color: #000;
    position: relative;
    box-shadow: 0 2px 6px rgba(0,0,0,0.15);
  }

  .options label {
    display: block;
    margin: 8px 0;
    padding: 8px;
    border-radius: 4px;
    transition: background-color 0.2s;
  }
  .options label:hover {
    background-color: rgba(0,64,128,0.05);
  }

  .feedback {
    margin-top: 10px;
    font-weight: bold;
  }

  .correct { color: green; }
  .incorrect { color: red; }

  .comment {
    margin-top: 5px;
    padding: 10px;
    border-left: 4px solid #004080;
    background: #eef5ff;
    display: none;
    transition: all 0.3s ease-in-out;
    opacity: 0;
  }
  .comment.show {
    display: block;
    opacity: 1;
  }

  button {
    margin: 5px;
    padding: 10px 15px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    transition: 0.3s;
    font-size: 14px;
  }

  button:hover {
    opacity: 0.9;
  }

  .btn-confirmar { background-color: #4CAF50; color: #fff; }
  .btn-corrigir-todas { background-color: #FF9800; color: #fff; }
  .btn-gabarito { background-color: #2196F3; color: #fff; }
  .btn-limpar { background-color: #f44336; color: #fff; }
  .btn-nav { background-color: #555; color: #fff; }

  #placarGlobal {
    background: #004080;
    color: white;
    padding: 15px;
    border-radius: 8px;
    font-weight: bold;
    box-shadow: 0 2px 10px rgba(0,0,0,0.3);
    max-width: 200px;
    margin-left: auto;
  }

  .cert-filter {
    background: rgba(255,255,255,0.95);
    padding: 15px;
    border-radius: 8px;
    margin-bottom: 20px;
    box-shadow: 0 2px 5px rgba(0,0,0,0.15);
  }

  .cert-filter select {
    padding: 10px;
    border-radius: 6px;
    border: 1px solid #ccc;
    font-size: 16px;
    width: 100%;
    max-width: 400px;
  }

  .cert-info {
    margin-top: 15px;
    padding: 10px;
    background: rgba(238,245,255,0.95);
    border-radius: 6px;
    display: none;
  }

  .cert-info h3 {
    margin-top: 0;
    color: #004080;
  }

  .loading {
    text-align: center;
    padding: 20px;
    font-size: 18px;
    color: #004080;
  }

  /* Controles de navegação responsivos */
  .controls {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    margin-bottom: 20px;
  }

  .page-navigation {
    display: flex;
    justify-content: space-between;
    margin-top: 20px;
    flex-wrap: wrap;
    gap: 10px;
  }

  /* Modal de confirmação de logoff */
  .modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.5);
    z-index: 1000;
    justify-content: center;
    align-items: center;
  }

  .modal-content {
    background: white;
    padding: 30px;
    border-radius: 10px;
    text-align: center;
    max-width: 400px;
    width: 90%;
    box-shadow: 0 5px 15px rgba(0,0,0,0.3);
  }

  .modal-buttons {
    display: flex;
    gap: 10px;
    justify-content: center;
    margin-top: 20px;
  }

  .btn-confirm {
    background: #f44336;
    color: white;
    padding: 10px 20px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
  }

  .btn-cancel {
    background: #757575;
    color: white;
    padding: 10px 20px;
    border: none;
    border-radius: 5px;
    cursor: pointer;
  }

  /* Media Queries para responsividade */
  @media (max-width: 768px) {
    .container {
      padding: 0 10px;
    }
    
    .header {
      flex-direction: column;
      gap: 15px;
      text-align: center;
    }
    
    #placarGlobal {
      margin: 10px auto;
      max-width: 100%;
      text-align: center;
    }
    
    .user-info {
      width: 100%;
      justify-content: center;
    }
    
    h1 {
      font-size: 1.5rem;
      text-align: center;
    }
    
    h2 {
      font-size: 1.3rem;
    }
    
    .question-header {
      flex-direction: column;
    }
    
    .question-actions {
      width: 100%;
      justify-content: center;
    }
    
    .controls {
      flex-direction: column;
    }
    
    .controls button {
      width: 100%;
      margin: 5px 0;
    }
    
    .page-navigation {
      flex-direction: column;
    }
    
    .page-navigation button {
      width: 100%;
      margin: 5px 0;
    }
    
    button {
      padding: 12px 15px;
      font-size: 16px;
    }
    
    .options label {
      padding: 12px;
      margin: 10px 0;
    }
    
    .question {
      padding: 12px;
    }

    .modal-content {
      padding: 20px;
    }

    .modal-buttons {
      flex-direction: column;
    }
  }

  @media (max-width: 480px) {
    h1 {
      font-size: 1.3rem;
    }
    
    h2 {
      font-size: 1.1rem;
    }
    
    .cert-filter select {
      font-size: 14px;
    }
    
    button {
      padding: 14px 15px;
    }
    
    .plusOne {
      font-size: 1em;
      right: 10px;
      top: 10px;
    }

    .user-info {
      flex-direction: column;
      text-align: center;
    }

    .user-details {
      align-items: center;
    }
  }

  /* Melhorias para imagens em telas pequenas */
  img {
    max-width: 100%;
    height: auto;
  }
</style>
</head>
<body>
  <!-- Modal de Confirmação de Logoff -->
  <div id="logoutModal" class="modal">
    <div class="modal-content">
      <h3>Confirmar Saída</h3>
      <p>Tem certeza que deseja sair do sistema?</p>
      <div class="modal-buttons">
        <button id="confirmLogout" class="btn-confirm">Sim, Sair</button>
        <button id="cancelLogout" class="btn-cancel">Cancelar</button>
      </div>
    </div>
  </div>

  <div class="container">
    <!-- Header com informações do usuário -->
    <div class="header">
      <div class="user-info">
        <div class="user-details">
          <div class="user-name" id="userName">Carregando...</div>
          <div class="user-email" id="userEmail">carregando@email.com</div>
        </div>
        <button class="btn-logoff" onclick="showLogoutModal()">
          <svg class="logout-icon" viewBox="0 0 24 24" fill="currentColor">
            <path d="M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z"/>
          </svg>
          Sair
        </button>
      </div>
      
      <div id="placarGlobal">Placar Total: 0/80</div>
    </div>

    <h1>Simulado de Certificações - Para CiberSegurança</h1>
    
    <!-- Filtro de certificações -->
    <div class="cert-filter">
      <label for="certSelect"><strong>Selecione a certificação:</strong></label>
      <select id="certSelect" onchange="loadCertification()">
        <option value="">-- Escolha uma certificação --</option>
        <option value="azure">Microsoft Azure DP-900</option>
        <option value="fortinet">Fortinet Cibersegurança</option>
        <option value="sc200">SC200 Microsoft</option>
        <option value="comptia">CompTIA Security+</option>
        <option value="cysa">CySA+</option>
        <option value="cisco-network">Cisco Network</option>
        <option value="cisco-security">Cisco CyberSecurity</option>
      </select>
      
      <div id="certInfo" class="cert-info">
        <!-- Informações da certificação serão inseridas aqui -->
      </div>
    </div>

    <!-- Conteúdo do simulado -->
    <div id="simuladoContent" style="display:none;">
      <p style="color: white;">
        Responda as questões. Use "Confirmar Resposta" para verificar individualmente ou "Corrigir Todas" para ver todas as respostas de uma vez.
      </p>

      <!-- PÁGINA 1 -->
      <div id="page1">
        <h2 style="color: white;">Parte 1 - Questões 1 a 30</h2>
        <div class="controls">
          <button class="btn-corrigir-todas" onclick="checkAllAnswers('quiz', getCurrentQuestions(1))">Corrigir Todas (Página 1)</button>
          <button class="btn-gabarito" onclick="showAnswers('quiz', getCurrentQuestions(1))">Mostrar Gabarito</button>
          <button class="btn-limpar" onclick="resetQuiz('quiz','result')">Limpar Respostas</button>
        </div>
        <div id="quiz"></div>
        <div id="result"></div>
        <div class="page-navigation">
          <button class="btn-nav" onclick="showPage(2)">Próxima Página</button>
        </div>
      </div>

      <!-- PÁGINA 2 -->
      <div id="page2" style="display:none;">
        <h2 style="color: white;">Parte 2 - Questões 31 a 60</h2>
        <div class="controls">
          <button class="btn-corrigir-todas" onclick="checkAllAnswers('quiz2', getCurrentQuestions(2))">Corrigir Todas (Página 2)</button>
          <button class="btn-gabarito" onclick="showAnswers('quiz2', getCurrentQuestions(2))">Mostrar Gabarito</button>
          <button class="btn-limpar" onclick="resetQuiz('quiz2','result2')">Limpar Respostas</button>
        </div>
        <div id="quiz2"></div>
        <div id="result2"></div>
        <div class="page-navigation">
          <button class="btn-nav" onclick="showPage(1)">Página Anterior</button>
          <button class="btn-nav" onclick="showPage(3)">Próxima Página</button>
        </div>
      </div>

      <!-- PÁGINA 3 -->
      <div id="page3" style="display:none;">
        <h2 style="color: white;">Parte 3 - Questões 61 a 80</h2>
        <div class="controls">
          <button class="btn-corrigir-todas" onclick="checkAllAnswers('quiz3', getCurrentQuestions(3))">Corrigir Todas (Página 3)</button>
          <button class="btn-gabarito" onclick="showAnswers('quiz3', getCurrentQuestions(3))">Mostrar Gabarito</button>
          <button class="btn-limpar" onclick="resetQuiz('quiz3','result3')">Limpar Respostas</button>
        </div>
        <div id="quiz3"></div>
        <div id="result3"></div>
        <div class="page-navigation">
          <button class="btn-nav" onclick="showPage(2)">Página Anterior</button>
        </div>
      </div>

      <!-- BOTÃO PARA CORRIGIR TODAS AS PÁGINAS -->
      <div style="text-align: center; margin-top: 30px;">
        <button class="btn-corrigir-todas" onclick="checkAllPages()" style="background-color: #9C27B0; font-size: 1.1em; padding: 12px 20px;">
          Corrigir Todas as Questões (Páginas 1, 2 e 3)
        </button>
      </div>
    </div>

    <div id="loadingMessage" class="loading" style="display: none; color: white;">
      Carregando questões...
    </div>
  </div>

  <script>
    // Configuração do Firebase (mesma do login)
    const firebaseConfig = {
      apiKey: "AIzaSyDFBV9NIVTdd7FLKt1F_3Mo6KDbRfTbsjI",
      authDomain: "simulador-de-certificacoes.firebaseapp.com",
      projectId: "simulador-de-certificacoes",
      storageBucket: "simulador-de-certificacoes.firebasestorage.app",
      messagingSenderId: "1079207323365",
      appId: "1:1079207323365:web:a3a3095dd50fe256d3160c"
    };

    // Inicializar Firebase
    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    // Elementos DOM
    const userNameElement = document.getElementById('userName');
    const userEmailElement = document.getElementById('userEmail');
    const logoutModal = document.getElementById('logoutModal');
    const confirmLogoutBtn = document.getElementById('confirmLogout');
    const cancelLogoutBtn = document.getElementById('cancelLogout');

    // Variáveis globais do simulador
    let placarTotal = parseInt(localStorage.getItem("placarTotal")) || 0;
    let currentCert = '';
    let currentQuestions = { questions: [], questions2: [], questions3: [] };

    // Verificar autenticação ao carregar a página
    auth.onAuthStateChanged((user) => {
      if (user) {
        // Usuário está logado
        loadUserData(user);
        updateGlobalPlacar();
      } else {
        // Usuário não está logado, redirecionar para login
        window.location.href = 'index.html';
      }
    });

    // Carregar dados do usuário
    async function loadUserData(user) {
      try {
        // Buscar dados adicionais do usuário no Firestore
        const userDoc = await db.collection('users').doc(user.uid).get();
        
        if (userDoc.exists) {
          const userData = userDoc.data();
          // Exibir nome do usuário (se disponível) ou e-mail
          const displayName = userData.name || user.displayName || user.email.split('@')[0];
          userNameElement.textContent = displayName;
          userEmailElement.textContent = user.email;
        } else {
          // Fallback para dados básicos do Auth
          userNameElement.textContent = user.displayName || user.email.split('@')[0];
          userEmailElement.textContent = user.email;
        }
      } catch (error) {
        console.error('Erro ao carregar dados do usuário:', error);
        // Fallback para dados básicos
        userNameElement.textContent = user.email.split('@')[0];
        userEmailElement.textContent = user.email;
      }
    }

    // Mostrar modal de confirmação de logoff
    function showLogoutModal() {
      logoutModal.style.display = 'flex';
    }

    // Fechar modal de confirmação
    function closeLogoutModal() {
      logoutModal.style.display = 'none';
    }

    // Realizar logoff
    async function performLogout() {
      try {
        await auth.signOut();
        // Limpar dados locais se necessário
        localStorage.removeItem('currentUser');
        localStorage.removeItem('loginTime');
        // Redirecionar para página de login
        window.location.href = 'login.html';
      } catch (error) {
        console.error('Erro ao fazer logoff:', error);
        alert('Erro ao sair do sistema. Tente novamente.');
      }
    }

    // Event listeners para o modal de logoff
    confirmLogoutBtn.addEventListener('click', performLogout);
    cancelLogoutBtn.addEventListener('click', closeLogoutModal);

    // Fechar modal ao clicar fora dele
    logoutModal.addEventListener('click', (e) => {
      if (e.target === logoutModal) {
        closeLogoutModal();
      }
    });

    // ================= FUNÇÕES EXISTENTES DO SIMULADOR =================
    // (Mantendo todas as funções originais do simulador)

    // Informações sobre as certificações
    const certInfo = {
      azure: {
        name: "Microsoft Azure",
        description: "Certificação focada em serviços de nuvem, segurança e governança da plataforma Azure.",
        focus: "Segurança de nuvem, identidade, governança, proteção de dados e gerenciamento de ameaças."
      },
      fortinet: {
        name: "Fortinet Cibersegurança",
        description: "Certificação especializada em soluções de segurança Fortinet, incluindo firewalls e proteção contra ameaças.",
        focus: "Firewalls FortiGate, FortiAnalyzer, FortiManager, detecção de intrusões e proteção contra ameaças avançadas."
      },
      sc200: {
        name: "SC200 Microsoft Security Operations Analyst",
        description: "Certificação focada em operações de segurança usando ferramentas Microsoft como Sentinel e Defender.",
        focus: "Microsoft Sentinel, Microsoft 365 Defender, Azure Defender, detecção de ameaças e resposta a incidentes."
      },
      comptia: {
        name: "CompTIA Security+",
        description: "Certificação fundamental em segurança da informação, reconhecida internacionalmente.",
        focus: "Conceitos de segurança, ameaças, vulnerabilidades, identidade, criptografia e operações de segurança."
      },
      cysa: {
        name: "CySA+ (Cybersecurity Analyst+)",
        description: "Certificação avançada focada em análise de segurança e operações de centro de segurança.",
        focus: "Análise de vulnerabilidades, monitoramento de ameaças, resposta a incidentes e conformidade."
      },
      "cisco-network": {
        name: "Cisco Network",
        description: "Certificação focada em infraestrutura de rede, roteamento e switching.",
        focus: "Roteamento, switching, redes wireless, segurança de rede e automação."
      },
      "cisco-security": {
        name: "Cisco CyberSecurity",
        description: "Certificação especializada em segurança de rede usando tecnologias Cisco.",
        focus: "Firewalls Cisco, sistemas de detecção/prevenção de intrusões, segurança de endpoints e VPNs."
      }
    };

    // Função para carregar a certificação selecionada
    function loadCertification() {
      const certSelect = document.getElementById('certSelect');
      const certInfoDiv = document.getElementById('certInfo');
      const simuladoContent = document.getElementById('simuladoContent');
      const loadingMessage = document.getElementById('loadingMessage');
      
      currentCert = certSelect.value;
      
      if (!currentCert) {
        certInfoDiv.style.display = 'none';
        simuladoContent.style.display = 'none';
        loadingMessage.style.display = 'none';
        return;
      }
      
      // Mostrar loading
      loadingMessage.style.display = 'block';
      simuladoContent.style.display = 'none';
      
      // Mostrar informações da certificação
      const info = certInfo[currentCert];
      certInfoDiv.innerHTML = `
        <h3>${info.name}</h3>
        <p><strong>Descrição:</strong> ${info.description}</p>
        <p><strong>Foco:</strong> ${info.focus}</p>
      `;
      certInfoDiv.style.display = 'block';
      
      // Carregar questões da certificação com pequeno delay para mostrar loading
      setTimeout(() => {
        loadQuestions(currentCert);
        loadingMessage.style.display = 'none';
        simuladoContent.style.display = 'block';
        showPage(1);
      }, 500);
    }

    // Função para obter as questões atuais baseadas na página
    function getCurrentQuestions(page) {
      switch(page) {
        case 1: return currentQuestions.questions;
        case 2: return currentQuestions.questions2;
        case 3: return currentQuestions.questions3;
        default: return [];
      }
    }

    // Função para carregar questões baseadas na certificação
    function loadQuestions(cert) {
      // Resetar questões
      currentQuestions = { questions: [], questions2: [], questions3: [] };
      
      // Gerar questões específicas para cada certificação
      switch(cert) {
        case 'azure':
          generateAzureQuestions();
          break;
        case 'fortinet':
          generateFortinetQuestions();
          break;
        case 'sc200':
          generateSC200Questions();
          break;
        case 'comptia':
          generateCompTIASecPlusQuestions();
          break;
        case 'cysa':
          generateCySAQuestions();
          break;
        case 'cisco-network':
          generateCiscoNetworkQuestions();
          break;
        case 'cisco-security':
          generateCiscoSecurityQuestions();
          break;
      }
      
      // Renderizar os quizzes
      renderQuiz("quiz", currentQuestions.questions, "quiz", 1);
      renderQuiz("quiz2", currentQuestions.questions2, "quiz2", 31);
      renderQuiz("quiz3", currentQuestions.questions3, "quiz3", 61);
    }

    // Funções de renderização e manipulação do quiz (mantidas do código original)
    function updateGlobalPlacar() {
      document.getElementById("placarGlobal").innerText = `Placar Total: ${placarTotal}/80`;
    }

    function renderQuiz(containerId, questions, storageKey, startNumber) {
      // ... (implementação original)
    }

    function saveAnswer(storageKey, qIndex, optionIndex) {
      // ... (implementação original)
    }

    function checkSingleAnswer(containerId, index, storageKey) {
      // ... (implementação original)
    }

    function getQuestionsByContainer(containerId) {
      // ... (implementação original)
    }

    function checkAllAnswers(containerId, questions) {
      // ... (implementação original)
    }

    function checkAllPages() {
      // ... (implementação original)
    }

    function updateResult(containerId, questions) {
      // ... (implementação original)
    }

    function showAnswers(containerId, questions) {
      // ... (implementação original)
    }

    function resetQuiz(containerId, resultId) {
      // ... (implementação original)
    }

    function showPage(pageNum) {
      // ... (implementação original)
    }

    // Funções de geração de questões (mantidas do código original)
    function generateAzureQuestions() {
      // ... (implementação original)
    }

    function generateFortinetQuestions() {
      // ... (implementação original)
    }

    function generateSC200Questions() {
      // ... (implementação original)
    }

    function generateCompTIASecPlusQuestions() {
      // ... (implementação original)
    }

    function generateCySAQuestions() {
      // ... (implementação original)
    }

    function generateCiscoNetworkQuestions() {
      // ... (implementação original)
    }

    function generateCiscoSecurityQuestions() {
      // ... (implementação original)
    }

    // Inicializar algumas questões de exemplo
    if (currentQuestions.questions.length === 0) {
      currentQuestions.questions = [
        {
          q: "Questão de exemplo 1: Qual é o principal objetivo da segurança da informação?",
          options: [
            "Proteger hardware",
            "Garantir confidencialidade, integridade e disponibilidade",
            "Implementar firewalls",
            "Realizar backups"
          ],
          answer: 1,
          comment: "O objetivo principal da segurança da informação é garantir a tríade CIA: Confidencialidade, Integridade e Disponibilidade."
        }
      ];
    }
  </script>
</body>
</html>

